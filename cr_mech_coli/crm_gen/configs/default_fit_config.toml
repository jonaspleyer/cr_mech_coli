# Default Fit Configuration for crm_gen
# =========================================================================
# Controls the optimisation hyperparameters for `crm_gen fit`.
# The input directory of real microscope images is passed as a CLI argument.

[optimization]
output_dir = ""                         # Output directory (empty = ./fit_results_<timestamp>)
limit = 0                               # Maximum number of images to use (0 = all)
n_vertices = 8                          # Number of vertices per cell for shape extraction
maxiter = 50                            # Maximum differential evolution iterations
popsize = 15                            # Population size multiplier (population = popsize * num_params)
workers = -1                            # Number of worker processes (-1 = all CPUs, 1 = sequential)
seed = 42                               # Random seed for reproducibility
resume = false                          # Resume from latest checkpoint
no_checkpoint = false                   # Disable checkpointing
save_all_synthetics = false             # Generate synthetic images for all pairs after optimisation

[optimization.metric_weights]
histogram_distance = 0.01               # Weight for histogram L1 distance
ssim = 1.0                              # Weight for SSIM (structural similarity)
psnr = 0.02                             # Weight for PSNR (peak signal-to-noise ratio)

[optimization.region_weights]
background = 0.65                       # Weight for background region loss
foreground = 0.35                       # Weight for foreground region loss

[optimization.bounds]
# Search bounds [min, max] for each imaging parameter during optimisation.
# These define the space explored by differential evolution.
bg_base_brightness  = [0.2,   0.6  ]   # Background base brightness
bg_gradient_strength = [0.0,  0.04 ]   # Illumination gradient intensity
bac_halo_intensity  = [0.01,  0.6  ]   # Halo intensity around bacteria
bg_noise_scale      = [1,     25   ]   # Background illumination noise scale
psf_sigma           = [0.1,   3.0  ]   # Point Spread Function (PSF) blur sigma
peak_signal         = [1,     10000]   # Peak photon count (Poisson noise)
gaussian_sigma      = [0.001, 0.05 ]   # Gaussian readout noise sigma
